<!doctype html>

<meta charset="utf-8">
<title>Dagre D3</title>

<link rel="stylesheet" href="https://dagrejs.github.io/project/dagre-d3/latest/demo/demo.css">
<script src="https://d3js.org/d3.v4.min.js" charset="utf-8"></script>
<script src="https://dagrejs.github.io/project/dagre-d3/latest/dagre-d3.js"></script>

<h1>Dagre D3 Demo</h1>

<style id="css">
/* This sets the color for "TK" nodes to a light blue green. */
g.type-DR > rect {
  fill: #00ffd0;
}

text {
  font-weight: 300;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serf;
  font-size: 14px;
}

.node rect {
  stroke: #999;
  fill: #fff;
  stroke-width: 1.5px;
}

.edgePath path {
  stroke: #333;
  stroke-width: 1.5px;
}

g.type-C > rect {
  fill: #66ccff;
}

text {
  font-weight: 300;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serf;
  font-size: 14px;
}

.node rect {
  stroke: #999;
  fill: #fff;
  stroke-width: 1.5px;
}

.edgePath path {
  stroke: #333;
  stroke-width: 1.5px;
}

g.type-closed > rect {
  fill: #b3b3cc;
}

text {
  font-weight: 300;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serf;
  font-size: 14px;
}

.node rect {
  stroke: #999;
  fill: #fff;
  stroke-width: 1.5px;
}

.edgePath path {
  stroke: #333;
  stroke-width: 1.5px;
}
</style>

<svg id="svg-canvas" width=600 height=400></svg>

<section>
<p>An example of visualizing the tokenization of a sentence. This example shows
how CSS classes can be applied to a rendered graph.
</section>

<script id="js">
// Create the input graph
var g = new dagreD3.graphlib.Graph()
  .setGraph({})
  .setDefaultEdgeLabel(function() { return {}; });

// Here we"re setting nodeclass, which is used by our custom drawNodes function
// below.
  g.setNode(0, {label: "complaint", class: "type-TOP"});
  g.setNode(1, {label: "eligibility determination", class: "type-ED"});
  g.setNode(2, {label: "eligible", class: "type-EE"});
  g.setNode(3, {label: "ineligible", class: "type-EI"});
  g.setNode(4, {label: "assessment", class: "type-A"});
  g.setNode(5, {label: "DR process", class: "type-DR"});
  g.setNode(6, {label: "DR monitoring", class: "type-DR"});
  g.setNode(7, {label: "transfer", class: "type-transfer"});
  g.setNode(8, {label: "compliance appraisal", class: "type-C"});
  g.setNode(9, {label: "compliance investigation", class: "type-C"});
  g.setNode(10, {label: "compliance monitoring", class: "type-C"});
  g.setNode(11, {label: "closed", class: "type-closed"});

g.nodes().forEach(function(v) {
  var node = g.node(v);
  // Round the corners of the nodes
  node.rx = node.ry = 5;
});

// Set up edges, no special attributes.
  g.setEdge(0, 1); // complaint > eligibility
  g.setEdge(1, 2); // eligibility > eligibile
  g.setEdge(1, 3); // eligibility > ineligibile
  g.setEdge(3, 11); // ineligibile > closed
  g.setEdge(2, 4); // eligibile > assessment
  g.setEdge(4, 5); // assessment > DR
  g.setEdge(4, 8); // assessment > compliance appraisal
  g.setEdge(5, 6); // DR > DR monitorinng
  g.setEdge(5, 7);// DR > transfer
  g.setEdge(6, 11);// DR monitoring > closed
  g.setEdge(6, 7);// DR monitoring > transfer
  g.setEdge(7, 8);// transfer > compliance appraisal
  g.setEdge(8, 9); // compliance appraisal > compliance investigation
  g.setEdge(8, 10); // compliance appraisal > compliance monitoring
  g.setEdge(8, 11);// compliance appraisal > closed
  g.setEdge(9, 10);// compliance investigation > compliance monitoring
  g.setEdge(9, 11);// compliance investigation > closed
  g.setEdge(10, 11)// compliance investigation > compliance monitoring

// Create the renderer
var render = new dagreD3.render();

// Set up an SVG group so that we can translate the final graph.
var svg = d3.select("svg"),
    svgGroup = svg.append("g");

// Run the renderer. This is what draws the final graph.
render(d3.select("svg g"), g);

// Center the graph
//var xCenterOffset = (svg.attr("width") - g.graph().width) / 2;
//svgGroup.attr("transform", "translate(" + xCenterOffset + ", 20)");
//svg.attr("height", g.graph().height + 40);
  
 svg.append("g")
      .call(new dagred3.render(), graph)
      .attr("transform", `scale(${(width > 1000) ? 1 : width/1000}) translate(${(width - graph.graph().width) / 2},20)`);
  
</script>

<script src="https://dagrejs.github.io/project/dagre-d3/latest/demo/demo.js"></script>
